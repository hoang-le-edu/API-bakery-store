import{h as g,u as R,e as N,d as E,r as i,j as e,m as b,f,S as y,o as j,n as h,p as D,l as O,q as w}from"./index-B0SyEzGp.js";const v=({orders:l,refetchOrder:x})=>{const{t:a}=g(),o=R(),{openPopup:n}=N(),{paymentLink:c,loading:u}=E(s=>s.payment),d=i.useRef(null),m=async s=>{try{d.current=s,o(D(l[s].order_id))}catch(r){console.error("Error fetching checkout URL:",r)}},p=async s=>{confirm("Are you sure you want to delete this cart?")&&await o(j(l[s].order_id)).then(()=>{h("success","Order has been canceled successfully"),x()}).catch(()=>{h("error","Error occurred while canceling order")})};return i.useEffect(()=>(c!==void 0&&c&&n({popupName:"qrPayment",paymentLink:c,order:l[d.current]}),()=>{o({type:"RESET_PAYMENT_LINK"})}),[c]),e.jsx("div",{className:"flex mt-4 shadow-lg rounded-lg",children:e.jsx("div",{className:"scrollbar-thin w-full gap-6 grid overflow-y-auto rounded-lg p-6 bg-gray-50 dark:bg-gray-900",children:l!==void 0&&l.length>0?l.map((s,r)=>e.jsxs("div",{className:"w-[100%] h-full border flex flex-col justify-between border-gray-300 p-5 rounded-xl shadow-md cursor-pointer hover:bg-gray-100 transition-all duration-300 ease-in-out",children:[e.jsxs("div",{className:"order-info flex w-full justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"text-lg font-semibold flex items-center gap-2",children:["#",s.order_number,e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["- ",b(s.order_date)]})]}),e.jsx("span",{className:`text-sm font-medium px-2 py-1 rounded-lg shadow-sm
                                    ${s.payment_method==="Cash"?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"}`,children:s.payment_method==="Cash"?"ðŸ›µ"+a("ORDERS.DETAIL_ORDER.PAYMENT_METHODS.COD"):"ðŸ’³"+a("ORDERS.DETAIL_ORDER.PAYMENT_METHODS.ONLINE")})]}),e.jsx("span",{className:`text-sm font-medium px-2 py-0.5 rounded-md shadow-sm
                                ${s.status==="Wait For Approval"?"bg-[#f26d78] text-white":s.status==="Completed"?"bg-green-200 text-green-800":s.status==="Cancelled"?"bg-red text-white":"bg-yellow-200 text-yellow-800"}`,children:s.status})]}),e.jsxs("div",{className:"overflow-y-auto w-full h-full scrollbar-thin mt-3",children:[s.order_detail.map(t=>e.jsx("div",{className:"order-item rounded-xl w-full last:pb-4",children:e.jsxs("div",{className:"flex h-full p-2 w-full items-center bg-white shadow-sm rounded-lg",children:[e.jsx("div",{className:"w-[10%] min-w-[60px]",children:e.jsx("img",{src:t.image||"storage/build/assets/Product/empty-image.png",alt:"Product",className:"w-full shadow-md rounded-lg aspect-square"})}),e.jsxs("div",{className:"flex flex-col w-full pl-3",children:[e.jsxs("span",{className:"text-md font-semibold text-gray-700",children:[t.product_name," (",t.size,")"]}),t.count_topping!==0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+ ",t.count_topping," toppings"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[a("ORDERS.DETAIL_ORDER.QUANTITY"),": ",t.quantity]}),t.note&&e.jsxs("span",{className:"text-xs text-gray-400",children:[a("ORDERS.DETAIL_ORDER.NOTE"),": ",t.note]})]}),e.jsx("div",{className:"font-semibold text-md text-green-600",children:f(t.total_price)})]})},t.id)),e.jsx("div",{className:"text-gray-600",children:e.jsxs("p",{className:"text-gray-600 text-md mt-2",children:[a("ORDERS.DETAIL_ORDER.NOTE"),": ",s.note]})})]}),s.status==="Wait For Approval"&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"w-full flex justify-between items-center",children:[e.jsxs("p",{className:"text-gray-600 text-md",children:[a("ORDERS.DETAIL_ORDER.TOTAL")," (",s.count_product," ",a("ORDERS.DETAIL_ORDER.PRODUCTS"),"): ",e.jsx("span",{className:"font-bold text-lg text-green-500",children:f(s.total_price)})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>p(r),className:"text-sm mr-2 bg-gray text-red-600 font-semibold hover:text-red-700 hover:bg-red transition-all px-3 py-1 rounded-full shadow-2xl",children:a("ORDERS.DETAIL_ORDER.CANCEL")}),s.payment_status==="pending"&&s.payment_method==="Banking"&&e.jsx("button",{onClick:()=>m(r),className:"text-sm bg-green-500 text-white font-semibold hover:bg-green-600 transition-all px-3 py-1 rounded-full",children:u&&d.current===r?e.jsx(y,{}):a("ORDERS.DETAIL_ORDER.PAY_NOW")})]})]})})]},s.order_id)):e.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full",children:[e.jsx("img",{src:"/storage/build/assets/no-data-found.png",alt:"No data",className:"w-80 opacity-60"}),e.jsx("span",{className:"text-gray-500 mt-2",children:a("ORDERS.NO_ORDERS")})]})})})},T=()=>{const{t:l}=g(),[x,a]=i.useState(!1),o=R(),n=E(s=>s.orders.orders),[c,u]=i.useState("Wait For Approval"),d=[{id:"Wait For Approval",label:l("ORDERS.WAIT_FOR_APPROVAL")},{id:"In Progress",label:l("ORDERS.IN_PROGRESS")},{id:"Delivering",label:l("ORDERS.DELIVERING")},{id:"Delivered",label:l("ORDERS.DELIVERED")},{id:"Completed",label:l("ORDERS.COMPLETED")},{id:"Cancelled",label:l("ORDERS.CANCELLED")}];i.useEffect(()=>{m()},[]),i.useEffect(()=>{console.log("newOrders",n)},[n]);const m=i.useCallback(O(async()=>{if(x)return;a(!0),await o(w(void 0,{})),a(!1)},500),[x,o]),p=s=>{let r=d.find(t=>t.id===s);u(r.id)};return e.jsx("div",{className:"m-auto flex items-center justify-center flex-col w-[80%] h-full mt-10",children:e.jsxs("div",{className:"flex p-6 gap-4 w-full h-full justify-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-3xl font-bold whitespace-nowrap",children:l("ORDERS.ORDER_HISTORY")}),e.jsx("div",{className:"flex flex-col mb-4 border-gray-200 dark:border-gray-700 mt-6",children:e.jsx("ul",{className:"flex flex-wrap flex-col gap-3 -mb-px text-sm font-semibold text-center",children:d.map(s=>{var r,t;return e.jsx("li",{className:"me-2 flex justify-end",children:e.jsxs("button",{className:`hover:bg-stone-300 shadow-lg inline-flex items-center px-4 py-3 rounded-lg w-[180px] ${c===s.id?"bg-blue-500 text-white":"hover:bg-stone-300"}`,id:`${s.id}-tab`,type:"button","aria-controls":`${s.id}-content`,"aria-selected":c===s.id,onClick:()=>p(s.id),children:[s.label," ",((r=n==null?void 0:n[s.id])==null?void 0:r.length)>0&&e.jsx("span",{className:"text-white bg-red rounded-full px-2 py-1 text-xs ml-2",children:(t=n==null?void 0:n[s.id])==null?void 0:t.length})]})},s.id)})})})]}),e.jsx("div",{className:"flex flex-col mt-2 w-full",children:x?e.jsx(y,{}):e.jsx(v,{orders:n==null?void 0:n[c],refetchOrder:m})})]})})};export{T as default};
